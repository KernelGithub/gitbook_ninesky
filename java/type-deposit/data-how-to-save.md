# **Java中数据在内存中是如何存储的**

1. 基本类型数据

   1. java的基本数据类前面已经说过，即byte、short、int 、long、double、float、char、boolean。基本类型的定义是通过诸如：int a  = 3;long b = 255L;的形式定义。如int a =3;这里的a是指向一个int类型的引用，指向3这个字面值。这些字面值的数据大小可知，生存期可知\(这些这面值定义在某个程序里面，程序退出后，字段值就消失了\)，存在栈中，存取速度快。

   2. 另外，栈还可以共享数据，  比如：int a = 3;  int b = 3;

      编译器先处理int a = 3;首先它会在栈中创建一个变量a的引用，然后查找有没有字面值为3的地址，没找到，就开辟一个存放3的字面量地址，然后将a指向3的地址。接着int b = 3 ；在创建完b这个引用变量后，由于字面值3已经在栈中，所有将b直接指向3的地址。这样，就出现了a与b同时均指向3的情况。     定义完a与b的值后，再令a = 4；那么，b不会等于4，还是等于3。在编译器内部，遇到时，它就会重新搜索栈中是否有4的字面值，如果没有，重新开辟地址存放4的值；如果已经有了，则直接将a指向这个地址。因此a值的改变不会影响到b的值。

2. 对象

   在java中，创建一个对象包括对象的声明和实例化两步。假设有类Rectangle

   1. ```
      public class Rectangle {
        double width;
        double height;
        public Rectangle( double w, double h){
          w = width;
          h = height;
        }
      }
      ```
   2. 声明对象时的内存模型:       用Rectangle rectangle; 声明一个对象rectangle时，将在**栈内存**为对象的引用变量rectangle分配内存空间，但值为空，是一个空对象。空对象不能使用，因为它还没有引用任何 “实体” 。

   3. 对象实例化时的内存模型:     当执行 rect = new Rectangle\(3,5\); 时，在堆内存中为类的成员变量width，height分配内存，并将其初始化为个数据类型的默认值；接着进行显示初始化（类定义时的初始值）；最后调用构造方法，为成员变量赋值 。返回堆内存中对象的引用（相当于首地址）给栈内存中的引用变量rectangle，以后就可以通过rectangle来引用堆内存中的对象了。

3. 创建多个不同的对象实例

   一个类通过使用new运算符可以创建多个不同的对象实例，这些对象实例将在堆中被分配不同的内存空间，改变其中一个对象的状态不会影响其他对象的状态。例如：

   ```
   Rectangle r1= new Rectangle(3,5);
   Rectangle r2= new Rectangle(4,6);
   ```

   此时，将在堆内存中分别为两个对象的成员变量 width 、 height 分配内存空间，两个对象在堆内存中占据的空间是互不相同的。如果有：

   ```
   Rectangle r1=new Rectangle(3,5);
   Rectangle r2=r1;
   ```

   则在堆内存中只创建了一个对象实例，在栈内存中创建了两个对象引用，两个对象引用同时指向一个对象实例。

4. 包装类

   基本类型都有对应的包装类：int -&gt;Integer，double-&gt;Double etc.基本类型的定义都是直接在栈中，如果用包装类来创建对象，就和普通对象一样了。例如：int i=0；i直接存储在栈中。Integer i（i此时是对象）= new Integer\(5\)；这样，i对象数据存储在堆中，i的引用存储在栈中，通过栈中的引用来操作对象。

5. String

   1. String是一个特殊的包装类数据。可以用两种方法创建：



